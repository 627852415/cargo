<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>BCB银行卡详情</title>
    <script type="text/javascript" th:src="@{/js/commonHead.js}"></script>
</head>
<style>



</style>

<body>
<form class="layui-form" action="" id="merchantForm" style="padding-top: 30px">
    <div class="layui-form-item">
        <label class="layui-form-label" >姓氏</label>
        <input type="hidden" name="id" id="dataId" th:value="${detail?.id}">
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.lastName}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">名字</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.firstName}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">护照</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.passportNum}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">国家(手机)</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.phoneCountryId}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">手机号</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.cellPhone}"  class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">电子邮箱</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.email}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">出生日期</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.birthDate}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">出生国家</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.countryBirth}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">性别</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.gender}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">邮政编码</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.zipCode}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">住宅国家</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.country}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">住宅州</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.state}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">住宅城市</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.cityName}" class="layui-input" disabled>
        </div>
    </div>

    <div class="layui-form-item">
        <label class="layui-form-label">住宅地址</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.street}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">银行卡种</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.bankCardTypeName}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">银行卡号</label>
        <div class="layui-input-block" style="width: 350px;">
            <input type="text" th:value="${detail?.cardNo}" class="layui-input" disabled>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">随机登录密码</label>
        <div class="layui-input-block" style="width: 350px;">
            <span id="loginpdId" style="display: none"  th:text="${detail?.loginPassword}" ></span>
            <input type="text" value="******" class="layui-input" disabled>
            <button type="button" class="layui-btn" onclick="showLoginPassword()">显示密码</button>
        </div>
    </div>

    <div class="layui-form-item" >
        <label class="layui-form-label">KYC-护照</label>
        <img onclick="imgZoom(this,'护照');"  class="layui-upload-img" name="image" style="width: 100px;height: 100px;" th:if="${detail?.kycImg != null}" th:src="${detail?.kycImg}">

        <button type="button" class="layui-btn layui-btn-danger"  th:unless="${detail?.kycImg != null}" >未上传</button>

    </div>

    <div class="layui-form-item" >
        <label class="layui-form-label">KYC-住址地址</label>
        <span></span>
        <img onclick="imgZoom(this,'住址地址');"  class="layui-upload-img" name="image" style="width: 100px;height: 100px;" th:if="${detail?.kycImgAddr != null}"  th:src="${detail?.kycImgAddr}">
        <button type="button" class="layui-btn layui-btn-danger" th:unless="${detail?.kycImgAddr != null}">未上传</button>
    </div>



    <input type="hidden" id = "statusData" th:value="${detail?.status}" class="layui-input" disabled />
    <input type="hidden" id = "isFirstAudit" th:value="${detail?.firstAudit}" class="layui-input" disabled />


    <div class="layui-form-item" id="reNoStateText"  style="display: none"  >
        <label class="layui-form-label">审核状态</label>
        <div class="layui-input-block" style="width: 350px;" th:switch="${detail?.status}">
            <input type="text" th:case="5" value="通过"  class="layui-input" disabled="true" />
            <input type="text" th:case="6" value="不通过"  class="layui-input" disabled="true" />
        </div>
    </div>

    <div id="applyBcbText" style="display: none" >
        <div class="layui-form-item"    >
            <label class="layui-form-label">审核记录</label>
            <div class="layui-input-block" style="width: 350px;">
                <input type="text" th:value="${detail?.remarks}"  class="layui-input" disabled="true" />
            </div>
        </div>
        <div class="layui-form-item"    >
            <label class="layui-form-label">审核人</label>
            <div class="layui-input-block" style="width: 350px;">
                <input type="text" th:value="${adminUserName}"  class="layui-input" disabled="true" />
            </div>
        </div>

        <div class="layui-form-item"    >
            <label class="layui-form-label">审核时间</label>
            <div class="layui-input-block" style="width: 350px;">
                <input type="text" th:value="${#dates.format(detail?.updateTime, 'yyyy-MM-dd HH:mm')}"  class="layui-input" disabled="true" />
            </div>
        </div>

    </div>




    <div id="reText"  style="display: none" class="layui-form-item"  >
        <div class="layui-form-item"    >
            <label class="layui-form-label">审核</label>
            <div class="layui-input-block" style="width: 350px;">
                <input type="radio" name="certificateStatus" value="true" title="审核通过" checked
                       lay-filter="certificateStatusEvent">
                <input type="radio" name="certificateStatus" value="false" title="不通过"
                       lay-filter="certificateStatusEvent">
            </div>
        </div>

        <div class="layui-form-item"   >
            <label class="layui-form-label">不通过原因</label>
            <div class="layui-input-block" style="width: 350px;">
                <input type="text"  name="remarks"  class="layui-input"  />
            </div>
        </div>
    </div>

    <div style="display: none" class="layui-form-item" id="subBtn">
        <div class="layui-input-block" style="margin-left: 200px;">
            <button class="layui-btn" onclick="return audit()" >提交</button>
        </div>
    </div>
</form>


<!-- 图片查看原图-->
<div id="imgDiv" style="display: none;">
    <div class="layui-form-item">
        <img class="layui-upload-img" id="imgId" src="">
    </div>
</div>

<script>

    var  showLoginpdFlag = false;

    function showLoginPassword() {
        if(!showLoginpdFlag){
            var ps = $("#loginpdId").html();
            $("#loginpdId").next("input").val(ps);
            $("#loginpdId").next("input").next("button").html("隐藏密码");

            showLoginpdFlag = true;
        }else {

            $("#loginpdId").next("input").val("******");
            $("#loginpdId").next("input").next("button").html("显示密码");
            showLoginpdFlag = false;
        }
    }

    /**
     * 查看原图
     * @param obj
     * @param title
     */
    function imgZoom(obj, title) {
        $("#imgId").attr("src", obj.src);
        layer.open({
            type: 1,
            closeBtn: 1,
            title: '<b>' + title + '</b>',
            area: [ '800px','800px'], //宽高
            content: $("#imgDiv")
        });
        layui.form.render(); //更新全部
    }


    function audit(){
        var remarks  = $("input[name='remarks']").val();
        var isPass  = $("input[name='certificateStatus']:checked").val();
        if(isPass==''||isPass===undefined){
            layer.alert('请先审核！');
            return false;
        }
        if(isPass!=null&&isPass==='false'&&remarks==''){
            layer.alert('不通过请填写备注!');
            return false;
        }
        var dataId  = $("#dataId").val();
        var params = {
            "id":dataId,
            "isPass":isPass=='true'?true:false,
            "remark":remarks
        }
        $.ajaxUkey({
            "url": "/bcb/bankcard/audit",
            "type": "post",
            "data": JSON.stringify(params),
            "contentType": "application/json",
            "dataType": "json",
            "success": function(result){
                layer.alert(result.data,function(){
                    window.location.reload();
                });
                return true;
            },
            "error": function(){
                layer.alert("请求出错");
                return false;
            }
        });
        return false;
    }


    $(function(){

        var state  = $("#statusData").val();
        //待审核
        if(state=='4'){
            $("#reText").show();
            $("#subBtn").show();
            //后台审核为通过
            //后台审核为失败
        }else if(state == '5' || state == '6') {
            $("#reNoStateText").show();
            $("#applyBcbText").show();
            $("#subBtn").hide();
        }

    });

</script>
</body>
</html>

